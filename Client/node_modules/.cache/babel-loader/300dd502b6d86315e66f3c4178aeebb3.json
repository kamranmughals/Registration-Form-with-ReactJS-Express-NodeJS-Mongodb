{"ast":null,"code":"var exec = require('child_process').exec;\nvar tree = require('./tree');\nvar utils = require('./utils');\nvar hasPS = true;\n\n// discover if the OS has `ps`, and therefore can use psTree\nexec('ps', function (error) {\n  module.exports.hasPS = hasPS = !error;\n});\nmodule.exports = function main(pid, callback) {\n  if (typeof pid === 'number') {\n    pid = pid.toString();\n  }\n  if (hasPS && !process.env.NO_PS) {\n    return tree(pid, callback);\n  }\n  utils.getStat().then(utils.tree).then(function (tree) {\n    return utils.pidsForTree(tree, pid);\n  }).then(function (res) {\n    return callback(null, res.map(function (p) {\n      return p.PID;\n    }));\n  }).catch(function (error) {\n    return callback(error);\n  });\n};\nif (!module.parent) {\n  module.exports(process.argv[2], function (e, pids) {\n    return console.log(pids);\n  });\n}\nmodule.exports.hasPS = hasPS;","map":null,"metadata":{},"sourceType":"script"}